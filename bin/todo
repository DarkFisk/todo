#!/usr/bin/env node

/**
 * External dependencies.
 */

var argv = require('argvee')();

/**
 * Internal dependencies.
 */

var Db = require('../lib/db');
var Todos = require('../lib/collection');

/**
 * Primary command.
 */

var command = argv.commands.shift();

/**
 * Todo items.
 */

var todos = new Todos(new Db('/tmp/todos.txt'));

process.on('uncaughtException', function(err) {
  console.error('todo: ' + err.message);
  process.exit(1);
});

if ('ls' === command) {
  console.log(todos.all());
  process.exit(0);
}

if ('add' === command) {
  var desc = argv.commands.join(' ');
  todos.create(desc);
}
